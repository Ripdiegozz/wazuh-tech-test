// ============================================
// Responsive Styles - Mobile & Tablet Support
// ============================================

// Breakpoints (using EUI patterns)
$breakpoint-xs: 480px;
$breakpoint-s: 768px;
$breakpoint-m: 992px;
$breakpoint-l: 1200px;

// ============================================
// Mobile First Overrides (max-width)
// ============================================

// Extra small devices (phones, less than 480px)
@media (max-width: $breakpoint-xs) {
  .todo-app {
    &__header {
      padding: $euiSizeS $euiSizeM;

      h1 {
        font-size: $euiFontSizeM;
        
        // Hide icon on very small screens
        .euiIcon {
          display: none;
        }
      }
    }

    &__nav {
      padding: 0 $euiSizeS;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      
      &::-webkit-scrollbar {
        display: none;
      }
    }

    &__nav-tab {
      padding: $euiSizeS;
      font-size: $euiFontSizeXS;
      white-space: nowrap;
      
      // Hide shortcut indicators on mobile
      .euiText {
        display: none;
      }
      
      // Smaller icons
      .euiIcon {
        width: 14px;
        height: 14px;
      }
    }

    &__content {
      padding: $euiSizeS;
    }
  }

  // Toolbar adjustments for mobile
  // Layout uses flex-wrap to flow naturally:
  .todo-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: $euiSizeS;
    align-items: center;

    // Search takes most of the first row
    &__search {
      flex: 1 1 200px;
      min-width: 150px;
      max-width: 100%;
      order: 1;
    }

    // Actions: Priority + Create stay together
    &__actions {
      display: flex;
      align-items: center;
      gap: $euiSizeS;
      margin-left: 0;
      order: 2;
      flex-shrink: 0;
      
      // Priority dropdown - compact
      .euiSuperSelect {
        min-width: 100px;
        max-width: 130px;
      }
      
      // Create button - always visible, compact on mobile
      .euiButton {
        white-space: nowrap;
        padding: $euiSizeS $euiSizeM !important;
        
        // Show only icon + text or just icon
        .euiButton__text {
          display: inline;
        }
      }
    }

    // Filters: full width row, scrollable
    &__filters {
      flex: 1 1 100%;
      order: 3;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: $euiSizeXS;
      margin: 0 (-$euiSizeS);
      padding-left: $euiSizeS;
      padding-right: $euiSizeS;
      
      // Hide scrollbar but keep functionality
      scrollbar-width: none;
      &::-webkit-scrollbar {
        display: none;
      }
      
      // Prevent wrap, allow scroll
      .euiFilterGroup {
        flex-wrap: nowrap;
        min-width: max-content;
      }
      
      // Compact filter buttons
      .euiFilterButton {
        white-space: nowrap;
        padding: $euiSizeXS $euiSizeS;
        font-size: $euiFontSizeXS;
        min-height: 36px;
      }
    }
  }

  // Kanban board - vertical layout for mobile (better drag&drop UX)
  .kanban-board {
    display: flex;
    flex-direction: column;
    gap: $euiSizeM;
    min-height: auto;
    padding-bottom: $euiSizeM;
  }

  .kanban-column {
    min-width: 100%;
    max-width: 100%;
    
    &__header {
      // Make header sticky for easier navigation
      position: sticky;
      top: 0;
      z-index: 1;
      background: inherit;
    }
    
    &__cards {
      // Limit card area height to prevent super long columns
      max-height: 350px;
      min-height: 100px;
      overflow-y: auto;
    }
    
    // Add button - always visible
    &__add-btn {
      margin-top: $euiSizeXS;
    }
  }

  // Cards - more compact
  .todo-card {
    padding: $euiSizeS;

    &__header {
      gap: $euiSizeXS;
    }

    &__title {
      font-size: $euiFontSizeS;
    }

    &__meta {
      flex-wrap: wrap;
      gap: $euiSizeXS;
    }
  }

  // Stats dashboard
  .stats-dashboard {
    &__metrics {
      grid-template-columns: repeat(2, 1fr) !important;
      gap: $euiSizeS !important;
    }

    &__charts {
      grid-template-columns: 1fr !important;
    }
  }

  // Detail panel - full width on mobile
  .euiFlyout {
    width: 100% !important;
    max-width: 100% !important;
  }

  // Markdown editor - reduced height on mobile
  .euiMarkdownEditor {
    .euiMarkdownEditorTextArea {
      min-height: 80px !important;
      max-height: 120px !important;
    }
  }

  // Action buttons - larger tap targets
  .euiButtonIcon {
    min-width: 40px;
    min-height: 40px;
  }

  // Editable markdown buttons
  .editable-markdown {
    .euiFlexGroup {
      gap: $euiSizeS;
    }
    
    .euiButtonIcon {
      width: 44px !important;
      height: 44px !important;
    }
  }

  // Modal - full screen on mobile
  .euiModal {
    width: calc(100% - #{$euiSizeS * 2}) !important;
    max-width: 100% !important;
    max-height: calc(100vh - #{$euiSizeL * 2}) !important;
    margin: $euiSizeS !important;
    
    .euiModalHeader {
      padding: $euiSizeS $euiSizeM !important;
    }
    
    .euiModalBody {
      flex: 1;
      overflow-y: auto;
      padding: $euiSizeS $euiSizeM !important;
    }
    
    .euiModalFooter {
      padding: $euiSizeS $euiSizeM !important;
    }
  }

  // Stats cards - more compact
  .stats-card {
    .euiStat__title {
      font-size: 1.75rem !important;
    }
    
    .euiStat__description {
      font-size: $euiFontSizeXS !important;
    }
  }

  .stats-compliance-badge {
    padding: $euiSizeXS !important;
    
    .euiText {
      font-size: $euiFontSizeXS !important;
    }
  }

  // Modal form inputs - stack vertically
  .euiModal {
    .euiFlexGroup:not(.euiModalFooter .euiFlexGroup) {
      flex-direction: column;
      
      .euiFlexItem {
        width: 100%;
        min-width: 100% !important;
      }
    }
    
    // Keep footer buttons horizontal
    .euiModalFooter .euiFlexGroup {
      flex-direction: row;
    }
  }

  // Table View - horizontal scroll with fixed columns
  .todo-table {
    // Container allows horizontal scroll
    overflow: visible;
    
    .euiTable {
      display: block;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      
      // Ensure minimum width for readability
      min-width: 600px;
    }
    
    // Bulk actions - stack buttons if needed
    &__bulk-actions {
      .euiFlexGroup {
        flex-wrap: wrap;
        gap: $euiSizeXS;
      }
      
      .euiButton {
        font-size: $euiFontSizeXS;
        padding: $euiSizeXS $euiSizeS;
      }
    }
    
    // Compact cells
    &__work-cell {
      min-width: 200px;
    }
    
    &__work-title {
      max-width: 150px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  }

  // Archived view - same treatment
  .archived-view__container {
    .euiTable {
      display: block;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      min-width: 600px;
    }
  }
}

// Small devices (landscape phones, tablets, 481px - 768px)
@media (min-width: #{$breakpoint-xs + 1}) and (max-width: $breakpoint-s) {
  .todo-app {
    &__header {
      padding: $euiSizeS $euiSizeM;
    }

    &__nav {
      padding: 0 $euiSizeM;
      flex-wrap: wrap;
    }

    &__nav-tab {
      padding: $euiSizeS $euiSizeS;
      
      // Hide shortcut indicators on tablets
      .euiText {
        display: none;
      }
    }

    &__content {
      padding: $euiSizeM;
    }
  }

  .todo-toolbar {
    &__search {
      min-width: 180px;
      max-width: 300px;
    }

    &__filters {
      flex: 1;
    }
  }

  // Kanban - 2 columns
  .kanban-board {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: $euiSizeS;
  }

  .kanban-column {
    min-width: 100%;
    max-width: 100%;
  }

  // Stats dashboard
  .stats-dashboard {
    &__metrics {
      grid-template-columns: repeat(2, 1fr) !important;
    }

    &__charts {
      grid-template-columns: 1fr !important;
    }
  }
}

// Medium devices (tablets, small laptops, 769px - 992px)
@media (min-width: #{$breakpoint-s + 1}) and (max-width: $breakpoint-m) {
  .kanban-board {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
  }

  .kanban-column {
    min-width: 100%;
    max-width: 100%;
  }

  .stats-dashboard {
    &__charts {
      grid-template-columns: repeat(2, 1fr) !important;
    }
  }
}

// ============================================
// Touch-friendly enhancements
// ============================================
@media (hover: none) and (pointer: coarse) {
  // Larger tap targets for touch devices
  .todo-app__nav-tab {
    min-height: 44px;
    padding: $euiSizeM;
  }

  .todo-card {
    // Slightly larger cards for easier tapping
    padding: $euiSizeM;
  }

  .kanban-column__add-btn {
    min-height: 44px;
  }

  // Better spacing for touch
  .todo-toolbar__filters .euiFilterButton {
    min-height: 40px;
  }

  // Hide hover-only elements
  .todo-card__menu-btn {
    opacity: 1;
  }
}

// ============================================
// Landscape orientation fixes
// ============================================
@media (max-height: 500px) and (orientation: landscape) {
  .todo-app__content {
    padding: $euiSizeS;
  }

  .kanban-board {
    min-height: auto;
  }

  .kanban-column__cards {
    max-height: 200px;
  }

  // Reduce modal/flyout height
  .euiFlyout {
    max-height: 100vh;
  }
}

@media print {
  .todo-app {
    &__nav,
    &__header {
      background: white !important;
    }
  }

  .todo-toolbar {
    display: none;
  }

  .kanban-board {
    display: block;
  }

  .kanban-column {
    page-break-inside: avoid;
    margin-bottom: $euiSizeL;
    max-width: 100%;
  }

  .todo-card {
    page-break-inside: avoid;
  }
}

